To solve the task, we can use a stack to keep track of the current nested level of parentheses. We'll also use a dictionary to store the count of each atom.

Here's the Python implementation of the `countOfAtoms` function:

```python
class Solution:
    def countOfAtoms(self, formula: str) -> str:
        stack = []
        count = {}
        i = 0

        while i < len(formula):
            if formula[i] == '(':
                stack.append(count)
                count = {}
                i += 1
            elif formula[i] == ')':
                inner_count = count
                count = stack.pop()
                i += 1
                multiplier = 0
                while i < len(formula) and formula[i].isdigit():
                    multiplier = multiplier * 10 + int(formula[i])
                    i += 1
                multiplier = max(multiplier, 1)
                for atom, freq in inner_count.items():
                    count[atom] = count.get(atom, 0) + freq * multiplier
            else:
                start = i
                i += 1
                while i < len(formula) and formula[i].islower():
                    i += 1
                atom = formula[start:i]
                freq = 0
                while i < len(formula) and formula[i].isdigit():
                    freq = freq * 10 + int(formula[i])
                    i += 1
                freq = max(freq, 1)
                count[atom] = count.get(atom, 0) + freq

        sorted_atoms = sorted(count.keys())
        result = ''
        for atom in sorted_atoms:
            result += atom
            if count[atom] > 1:
                result += str(count[atom])
        return result
```

Now we can create an instance of the `Solution` class and test the function with the provided examples:

```python
solution = Solution()

formula = "H2O"
print(solution.countOfAtoms(formula))  # Output: "H2O"

formula = "Mg(OH)2"
print(solution.countOfAtoms(formula))  # Output: "H2MgO2"

formula = "K4(ON(SO3)2)2"
print(solution.countOfAtoms(formula))  # Output: "K4N2O14S4"
```

The function should return the expected outputs as mentioned in the examples.