Here is the code implementation for the given task:

```python
class Allocator:

    def __init__(self, n: int):
        self.memory = [0] * n
        self.block_dict = {}
    
    def allocate(self, size: int, mID: int) -> int:
        for i in range(len(self.memory)):
            if self.memory[i] == 0:
                available = True
                for j in range(size):
                    if i+j >= len(self.memory) or self.memory[i+j] != 0:
                        available = False
                        break
                if available:
                    for j in range(size):
                        self.memory[i+j] = mID
                    if mID in self.block_dict:
                        self.block_dict[mID].append(i)
                    else:
                        self.block_dict[mID] = [i]
                    return i
        return -1
    
    def free(self, mID: int) -> int:
        if mID in self.block_dict:
            count = 0
            for block in self.block_dict[mID]:
                for i in range(block, len(self.memory)):
                    if self.memory[i] == mID:
                        self.memory[i] = 0
                        count += 1
                    else:
                        break
            del self.block_dict[mID]
            return count
        return 0
```


Example usage:
```python
if __name__ == "__main__":
    allocator = Allocator(10)
    print(allocator.allocate(1, 1))
    print(allocator.allocate(1, 2))
    print(allocator.allocate(1, 3))
    print(allocator.free(2))
    print(allocator.allocate(3, 4))
    print(allocator.allocate(1, 1))
    print(allocator.allocate(1, 1))
    print(allocator.free(1))
    print(allocator.allocate(10, 2))
    print(allocator.free(7))
```

